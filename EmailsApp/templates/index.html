<!DOCTYPE html>
<html lang="en">

<head>
   <meta content="" name="description">
    <meta content="" name="keywords">
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- CDNs -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Roboto:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
      rel="stylesheet">

    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css"
      integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous" />
    
<title>Emails Data</title>
</head>


<body  style="margin-right: 20px;margin-left: 20px">
    <div style="width:100% ; overflow-x: hidden">


  <h1 style="font-size:40px ;font-family: 'Josefin Sans', sans-serif" class="title-5 ml-5 mt-3 text-center">Liste des
    Emails </h1>

     <form method="post" action="{% url 'index' %}" enctype="multipart/form-data">
      {% csrf_token %}
      <div class="row">

      <div class="input-group mb-3 w-25 ml-3 float-sm-left ">
        <div class="custom-file">
          <input type="file" class="custom-file-input" id="inputGroupFile02" name="datafile" >
          <label class="custom-file-label" for="inputGroupFile02">Choose file</label>
        </div>
        <div class="input-group-append">
          <button type="submit" class="input-group-text" >Import New Data</button>
        </div>
      </div>
      </div>
     
      </form>
      
      <form id="getForm" action="" method="get">
        <div class="row">
          <div class="col">
            <div class="input-group input-group-sm" >
              <div class="input-group-prepend">
                <label class="input-group-text" for="inputGroupSelect01">Gender</label>
              </div>
              <select class="custom-select" id="inputGroupSelect01">
                <option selected>Choose...</option>
                <option value="F">Female</option>
                <option value="M">Male</option>
              </select>
            </div>
          </div>
          <div class="col" >
            <div class="input-group input-group-sm">
              <div class="input-group-prepend">
                <label class="input-group-text" for="job_role" >Job role/niche</label>
              </div>
              <select class="custom-select" id="job_role" name="job_role" form="getForm" >
                <option>select job role</option>
                {% for item in list_job_title_role %}
                  <option value="{{ item }}" style="text-transform: capitalize" >{{ item }}</option>
                {% endfor %}           
              </select>
            </div>           
          </div>
          <div class="col">
            <div class="input-group input-group-sm">
              <div class="input-group-prepend">
                <label class="input-group-text" for="job_sub_role">Job sub role</label>
              </div>
              <select class="custom-select" id="job_sub_role" name="job_sub_role" form="getForm">
                <option>select job sub role</option>

              </select>
            </div>                   
          </div>
           <div class="col">
            <div class="input-group input-group-sm">
              <div class="input-group-prepend">
                <label class="input-group-text" for="continent">Continent</label>
              </div>
              <select class="custom-select" id="continent" name="continent" >
                <option>select continent</option>
                <option value="africa">Africa</option>
                <option value="asia">Asia</option>
                <option value="europe">Europe</option>
                <option value="oceania">Oceania</option>
                <option value="north">North America</option>
                <option value="south">South America</option>            
              </select>
            </div>          
          </div>
           <div class="col">
            <div class="input-group input-group-sm">
              <div class="input-group-prepend">
                <label class="input-group-text" for="country">Country</label>
              </div>
              <select class="custom-select" id="country" name="country">
                <option>select Country</option>
                
              </select>
            </div>                      
          </div>
           <div class="col">
            <div class="input-group input-group-sm">
              <div class="input-group-prepend">
                <label class="input-group-text" for="language">Language</label>
              </div>
              <select class="custom-select" id="language" name="language">
                <option>select language</option>
                {% for item in list_language %}
                  <option value="{{ item }}" style="text-transform: capitalize">{{ item }}</option>
                {% endfor %}           
              </select>
            </div>            
          </div>
           <div class="col">
            <button type="submit" class="btn btn-primary mb-2">Submit</button>
          </div>
           
        </div>
      </form>


  <div class="table-data__tool">

   

    <div class="table-data__tool-right">
      <a href=""><button class="au-btn au-btn-icon au-btn--blue au-btn--small">
          <i class="fad fa-download"></i>Telecharger CSV</button> </a>   
    </div>
  </div>

  <div class="table-responsive table-responsive-data2">
    <table class="table table-data2" id="DataTable">
      <thead class="table-dark">
        <tr>

          <th style=" color:White">Full name</th>
          <th style="color:White">Gender</th>
          <th style="color:White">Job title</th>
          <th style="color:White">Job title role</th>
          <th style="color:White">Job title sub role</th>
          <th style="color:White">Country</th>
          <th style="color:White">Continent</th>
          <th style="color:White">Language</th>
          <th style="color:White">Emails</th>
        </tr>
      </thead>
      <tbody id='DataTabletBody'>

{% comment %} 
        {% for eq_list in eq %}

        <tr
          style="
    {% if eq_list.type_equipement_id == 1 %}background-color:rgb(253, 230, 211){%endif%}{% if eq_list.type_equipement_id == 2 %}background-color:rgb(227, 250, 198){%endif%}{% if eq_list.type_equipement_id == 3 %}background-color:rgb(211, 253, 237){%endif%} "
          class="tr-shadow">
          <td>{{ forloop.counter}}</td>
          <td>{{ eq_list.ref_equipement }}</td>
          <td>{{ eq_list.serie_equipement }}</td>
          <td>{{ eq_list.type_equipement }}</td>
          <td>{{ eq_list.emplacement_equipement }}</td>
          <td>{{ eq_list.designation_equipement }}</td>
          <td>{{ eq_list.client_equipement }}</td>
          <td>{{ eq_list.date_debut_fonctionnement_equipement }}</td>
          <td>
            <div class="table-data-feature">

              <a href="{% url 'modifier' eq_list.id %}"> <button class="item mr-4" data-toggle="tooltip"
                  data-placement="top" title="Edit">
                  <i class="zmdi zmdi-edit"></i>
                </button> </a>
              <a href="{% url 'delete' eq_list.id %}"> <button class="item"
                  onclick="return confirm('Confirmer la suppression');" data-toggle="tooltip" data-placement="top"
                  title="Delete">
                  <i class="zmdi zmdi-delete"></i>
                </button> </a>

            </div>
          </td>

        </tr>
        {% endfor %} {% endcomment %}
      </tbody>
    </table>
  </div>

 
      
      </div>
    </div>
  </div>
  <script>
    //LINKED DROPDOWN LISTS FOR job_role AND job_sub_role :
    document.getElementById("job_role").addEventListener("change",function(){
        document.getElementById("job_sub_role").innerHTML="";
        document.getElementById("DataTabletBody").innerHTML="";
        $.ajax({
          type:'GET',
          url:"getJobSubRole/",
          data:{
              job_role:$("#job_role").val(),
          },
          dataType:'json',
          success:function(response){
              var select=document.getElementById("job_sub_role");
              for(var i=0; i<response.list_job_title_sub_role.length;i++){
                var option = document.createElement("option");
                option.value = response.list_job_title_sub_role[i];
                option.innerHTML = response.list_job_title_sub_role[i].replace("_"," ");
                option.style.textTransform= "capitalize";
                select.appendChild(option);
              }
            
              for(var i=0; i<response.data.length;i++){
              $('#DataTable').append(`<tr><td>${response.data[i].full_name}</td><td>${response.data[i].gender}</td><td>${response.data[i].job_title}</td><td>${response.data[i].job_title_role}</td><td>${response.data[i].job_title_sub_role}</td><td>${response.data[i].location_country}</td><td>${response.data[i].location_continent}</td><td>${response.data[i].languages}</td><td>${response.all_emails[i].join('<br>')}</td></tr>`);
              }
             


          },
        });
    });
  //LINKED DROPDOWN LISTS FOR Continent AND Country :

          document.getElementById("continent").addEventListener("change",function(){
            document.getElementById("country").innerHTML="";
            $.ajax({
              type:'GET',
              url:"getCountry/",
              data:{
                continent:$("#continent").val(),
              },
              dataType:'json',
              success:function(response){
                  var select=document.getElementById("country");
                  for(var i=0; i<response.list_countries.length;i++){
                    var option = document.createElement("option");
                    option.value = response.list_countries[i];
                    option.innerHTML = response.list_countries[i];
                    option.style.textTransform= "capitalize";
                    select.appendChild(option);
                  }
    
              },
            });
        });
        // SEND FORM 
    
                  </script>

</body>


</html>